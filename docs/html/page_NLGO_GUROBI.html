<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>CRONOS: Nonlinear Global Optimization using MC++ and GUROBI</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CRONOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_NLGO_GUROBI.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Nonlinear Global Optimization using MC++ and GUROBI </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Benoit C. Chachuat <code>(<a href="#" onclick="location.href='mai'+'lto:'+'b.c'+'ha'+'chu'+'at'+'@im'+'pe'+'ria'+'l.'+'ac.'+'uk'; return false;">b.cha<span style="display: none;">.nosp@m.</span>chua<span style="display: none;">.nosp@m.</span>t@imp<span style="display: none;">.nosp@m.</span>eria<span style="display: none;">.nosp@m.</span>l.ac.<span style="display: none;">.nosp@m.</span>uk</a>)</code> and OMEGA Research Group (<a href="http://www3.imperial.ac.uk/environmentenergyoptimisation">http://www3.imperial.ac.uk/environmentenergyoptimisation</a>) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2015 </dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000002">Bug:</a></b></dt><dd>No known bugs.</dd></dl>
<p>Consider a nonlinear optimization problem in the form: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align*} \mathcal{P}:\quad &amp; \min_{x_1,\ldots,x_n}\ f(x_1,\ldots,x_n)\\ &amp; {\rm s.t.}\ \ g_j(x_1,\ldots,x_n)\ \leq,=,\geq\ 0,\ \ j=1,\ldots,m\\ &amp; \qquad x_i^L\leq x_i\leq x_i^U,\ \ i=1,\ldots,n\,, \end{align*}" src="form_5.png"/>
</p>
<p> where <img class="formulaInl" alt="$f, g_1, \ldots, g_m$" src="form_6.png"/> are factorable, potentially nonlinear, real-valued functions; and <img class="formulaInl" alt="$x_1, \ldots, x_n$" src="form_7.png"/> can be either continuous or integer decision variables. The class <a class="el" href="classmc_1_1NLGO__GUROBI.html" title="C++ class for global optimization of NLP and MINLP using complete search. ">mc::NLGO_GUROBI</a> solves such NLP or MINLP problems to global optimality using complete search. Two main methods are implemented in <a class="el" href="classmc_1_1NLGO__GUROBI.html" title="C++ class for global optimization of NLP and MINLP using complete search. ">mc::NLGO_GUROBI</a>:</p>
<ul>
<li>spatial branch-and-bound search</li>
<li>hierarchy of semi-linear relaxations</li>
</ul>
<p>In both methods, relaxations are generated for the nonlinear or nonconvex participating terms using various arithmetics in <a href="https://projects.coin-or.org/MCpp">MC++</a>.</p>
<h1><a class="anchor" id="sec_NLGO_GUROBI_setup"></a>
How do I setup my optimization model?</h1>
<p>Consider the following NLP: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align*} \max_{\bf p}\ &amp; p_1\,p_4\,(p_1+p_2+p_3)+p_3 \\ \text{s.t.} \ &amp; p_1\,p_2\,p_3\,p_4 \geq 25 \\ &amp; p_1^2+p_2^2+p_3^2+p_4^2 = 40 \\ &amp; 1 \leq p_1,p_2,p_3,p_4 \leq 5\,. \end{align*}" src="form_8.png"/>
</p>
<p>First, we define an <a class="el" href="classmc_1_1NLGO__GUROBI.html" title="C++ class for global optimization of NLP and MINLP using complete search. ">mc::NLGO_GUROBI</a> class as below:</p>
<div class="fragment"><div class="line"><a class="code" href="classmc_1_1NLGO__GUROBI.html">mc::NLGO_GUROBI</a> NLP;</div>
</div><!-- fragment --><p>Next, we set the variables and objective/constraint functions by creating a direct acyclic graph (DAG) of the problem:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;NLGO_GUROBI.hpp&quot;</span></div>
<div class="line"></div>
<div class="line">mc::FFGraph DAG;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">unsigned</span> NP = 4; mc::FFVar p[NP];</div>
<div class="line"><span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> i=0; i&lt;NP; i++ ) p[i].set( &amp;DAG );</div>
<div class="line"></div>
<div class="line">NLP.set_dag( &amp;DAG );  <span class="comment">// DAG</span></div>
<div class="line">NLP.set_var( NP, p ); <span class="comment">// decision variables</span></div>
<div class="line">NLP.set_obj( mc::BASE_NLP::MIN, (p[0]*p[3])*(p[0]+p[1]+p[2])+p[2] ); <span class="comment">// ojective</span></div>
<div class="line">NLP.add_ctr( mc::BASE_NLP::GE,  (p[0]*p[3])*p[1]*p[2]-25 );          <span class="comment">// constraints</span></div>
<div class="line">NLP.add_ctr( mc::BASE_NLP::EQ,  sqr(p[0])+sqr(p[1])+sqr(p[2])+sqr(p[3])-40 );</div>
<div class="line">NLP.<a class="code" href="group__NLGO__GUROBI.html#ga37fa190ca7e26eb2970f33387a71ccab">setup</a>();</div>
</div><!-- fragment --><p>The variable bounds and types are passed to <a class="el" href="classmc_1_1NLGO__GUROBI.html" title="C++ class for global optimization of NLP and MINLP using complete search. ">mc::NLGO_GUROBI</a> in invoking the various methods, as described below.</p>
<h1><a class="anchor" id="sec_NLGO_GUROBI_methods"></a>
What are the methods available?</h1>
<p>Given initial bounds <img class="formulaInl" alt="$P$" src="form_3.png"/> and initial guesses <img class="formulaInl" alt="$p_0$" src="form_4.png"/> on the decision variables, the NLP model is solved using branch-and-bound search (default) as follows:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;interval.hpp&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">typedef</span> mc::Interval I;</div>
<div class="line">I Ip[NP] = { I(1,5), I(1,5), I(1,5), I(1,5) };</div>
<div class="line"></div>
<div class="line">std::cout &lt;&lt; NLP;</div>
<div class="line"><span class="keywordtype">int</span> status = NLP.<a class="code" href="group__NLGO__GUROBI.html#gad67eaa2ead046f3359d0bce81b991044">solve</a>( Ip );</div>
</div><!-- fragment --><p>The return value is the <a href="http://www.gurobi.com/documentation/6.0/refman/optimization_status_codes.html">GUROBI status</a>, which is of integer type. The following result is produced:</p>
<pre class="fragment">______________________________________________________________________

               NONLINEAR GLOBAL OPTIMIZATION IN CRONOS
______________________________________________________________________

  COMPLETE SEARCH METHOD                                    SBB
  CONVERGENCE ABSOLUTE TOLERANCE                            1.0e-03
  CONVERGENCE RELATIVE TOLERANCE                            1.0e-03
  ROOT NODE PROPROCESSING                                   Y
  OPTIMIZATION-BASED REDUCTION MAX LOOPS                    10
  OPTIMIZATION-BASED REDUCTION THRESHOLD LOOP               20%
  MAXIMUM ITERATION COUNT                                   -
  MAXIMUM CPU TIME (SEC)                                    7.2e+03
  DISPLAY LEVEL                                             2
 _______________________________________________________________________

 INDEX STACK    CUMUL TIME        RELAX         INC   PARENT        LBD           UBD         ACTION  

     1     1  0.000000e+00 -1.000000e+20  1.701402e+01     0  1.511037e+01  1.701402e+01       BRANCH2
     2     2  2.446400e-02  1.511037e+01  1.701402e+01     1  1.659980e+01  1.701402e+01       BRANCH3
     3     3  3.611400e-02  1.511037e+01  1.701402e+01     1  1.614164e+01  1.701402e+01       BRANCH2
     4     4  5.255800e-02  1.614164e+01  1.701402e+01     3  1.669923e+01  1.701402e+01       BRANCH3
     5     5  6.833200e-02  1.614164e+01  1.701402e+01     3  1.713529e+01       SKIPPED        FATHOM
     6     4  8.233300e-02  1.659980e+01  1.701402e+01     2  1.664991e+01  1.701402e+01       BRANCH2
     7     5  9.279500e-02  1.659980e+01  1.701402e+01     2  1.701402e+01       SKIPPED        FATHOM
     8     4  1.237580e-01  1.664991e+01  1.701402e+01     6  1.703133e+01       SKIPPED        FATHOM
     9     3  1.286230e-01  1.664991e+01  1.701402e+01     6  1.701402e+01       SKIPPED        FATHOM
    10     2  1.553660e-01  1.669923e+01  1.701402e+01     4  1.672776e+01  1.701402e+01       BRANCH3
    11     3  1.638520e-01  1.669923e+01  1.701402e+01     4  1.701406e+01       SKIPPED        FATHOM
    12     2  1.661390e-01  1.672776e+01  1.701402e+01    10  1.676720e+01  1.704213e+01       BRANCH2
    13     3  1.748900e-01  1.672776e+01  1.701402e+01    10  1.701402e+01       SKIPPED        FATHOM
    14     2  2.044000e-01  1.676720e+01  1.701402e+01    12    INFEASIBLE       SKIPPED        FATHOM
    15     1  2.149610e-01  1.676720e+01  1.701402e+01    12  1.703627e+01       SKIPPED        FATHOM

#  NORMAL TERMINATION: 0.222576 CPU SEC  (LBD:80.6%  UBD:19.3%)
#  INCUMBENT VALUE:  1.701402e+01
#  INCUMBENT POINT:  1.000000e+00  4.742955e+00  3.821208e+00  1.379400e+00
#  INCUMBENT FOUND AT NODE: 10
#  TOTAL NUMBER OF NODES:   15
#  MAXIMUM NODES IN STACK:  5
</pre><p>Integrality of certain variables can be enforced by passing an additional argument as follows, here enforcing integrality of the second and third variables:</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> Tp[NP] = { 0, 1, 1, 0 };</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> status = NLP.solve( Ip, Tp );</div>
</div><!-- fragment --><p>The following result is now produced:</p>
<pre class="fragment"> INDEX STACK    CUMUL TIME        RELAX         INC   PARENT        LBD           UBD         ACTION  

     1     1  0.000000e+00 -1.000000e+20  1.000000e+20     0  1.224000e+01  2.312461e+01       BRANCH0
     2     2  2.387200e-02  1.224000e+01  2.312461e+01     1  1.224000e+01  2.312461e+01       BRANCH1
     3     3  3.766500e-02  1.224000e+01  2.312461e+01     1  3.200000e+01       SKIPPED        FATHOM
     4     2  4.145500e-02  1.224000e+01  2.312461e+01     2  2.501911e+01       SKIPPED        FATHOM
     5     1  7.219900e-02  1.224000e+01  2.312461e+01     2  1.488304e+01  2.312461e+01       BRANCH2
     6     2  1.082510e-01  1.488304e+01  2.312461e+01     5  2.312460e+01       SKIPPED        FATHOM
     7     1  1.395070e-01  1.488304e+01  2.312461e+01     5  2.012448e+01  2.312461e+01       BRANCH1
     8     2  1.729230e-01  2.012448e+01  2.312461e+01     7  2.511437e+01       SKIPPED        FATHOM
     9     1  1.866310e-01  2.012448e+01  2.312461e+01     7  2.312458e+01       SKIPPED        FATHOM

#  NORMAL TERMINATION: 0.215300 CPU SEC  (LBD:94.3%  UBD:5.7%)
#  INCUMBENT VALUE:  2.312461e+01
#  INCUMBENT POINT:  1.000000e+00  5.000000e+00  3.000000e+00  2.236068e+00
#  INCUMBENT FOUND AT NODE: 7
#  TOTAL NUMBER OF NODES:   9
#  MAXIMUM NODES IN STACK:  3
</pre><p>The complete search algorithm based on piecewise linearization can be selected by modifying the options as follows:</p>
<div class="fragment"><div class="line">NLP.options.CSALGO = <a class="code" href="classmc_1_1NLGO__GUROBI.html">mc::NLGO_GUROBI&lt;I&gt;::Options::PWL</a>;</div>
<div class="line">NLP.<a class="code" href="group__NLGO__GUROBI.html#gaddb8cef91dad19917d58335fa69bebe1">options</a>.<a class="code" href="structmc_1_1NLGO__GUROBI_1_1Options.html#a7396598b90bc6f399864c51cc8f5f3e5">POLIMG</a>.BREAKPOINT_TYPE = mc::PolImg&lt;I&gt;::Options::BIN;</div>
<div class="line"><span class="keywordtype">int</span> status = NLP.solve( Ip, Tp );</div>
</div><!-- fragment --><p>The following result is now produced:</p>
<pre class="fragment">     ITER  PREPROC      RELAX          BEST        CPU TOT          STATUS
        1        -  1.224000e+01  2.312461e+01  5.066300e-02        REFINE
        2        -  1.410526e+01  2.312461e+01  1.267340e-01        REFINE
        3       R3  1.425993e+01  2.312461e+01  2.750010e-01        REFINE
        4       R1  1.488303e+01  2.312461e+01  3.852940e-01        REFINE
        5       R3  2.312456e+01  2.312461e+01  5.360410e-01       OPTIMAL

#  TERMINATION: 0.536041 CPU SEC
#  INCUMBENT VALUE:  2.312461e+01
#  INCUMBENT POINT:  1.000000e+00  5.000000e+00  3.000000e+00  2.236068e+00
#  NUMBER OF RELAXATION REFINEMENTS:   5
#  OPTIMALITY GAP:   4.746061e-05 (ABS)
                     2.052387e-06 (REL)
</pre><p>Other options can be modified to tailor the search, including output level, maximum number of iterations, tolerances, maximum CPU time, etc. These options can be modified through the public member <a class="el" href="group__NLGO__GUROBI.html#gaddb8cef91dad19917d58335fa69bebe1" title="NLGO_GUROBI options. ">mc::NLGO_GUROBI::options</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Oct 7 2015 20:40:15 for CRONOS by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
