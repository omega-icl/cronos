<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>CRONOS: Local (Continuous) Optimization using IPOPT</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CRONOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_NLPSLV_IPOPT.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Local (Continuous) Optimization using IPOPT </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Benoit C. Chachuat </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2014 </dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>No known bugs.</dd></dl>
<p>Consider a nonlinear optimization problem in the form: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align*} \mathcal{P}:\quad &amp; \min_{x_1,\ldots,x_n}\ f(x_1,\ldots,x_n)\\ &amp; {\rm s.t.}\ \ g_j(x_1,\ldots,x_n)\ \leq,=,\geq\ 0,\ \ j=1,\ldots,m\\ &amp; \qquad x_i^L\leq x_i\leq x_i^U,\ \ i=1,\ldots,n\,, \end{align*}" src="form_5.png"/>
</p>
<p> where <img class="formulaInl" alt="$f, g_1, \ldots, g_m$" src="form_6.png"/> are factorable, potentially nonlinear, real-valued functions; and <img class="formulaInl" alt="$x_1, \ldots, x_n$" src="form_7.png"/> are continuous decision variables. The class <a class="el" href="classmc_1_1NLPSLV__IPOPT.html" title="C++ derived class for NLP solution using IPOPT and FADBAD++. ">mc::NLPSLV_IPOPT</a> solves such NLP problems using the software package <a href="https://projects.coin-or.org/Ipopt">IPOPT</a>, which implements a local solution method (interior point). IPOPT requires the first and second derivatives as well as the sparsity pattern of the objective and constraint functions in the NLP model. This information is generated using direct acyclic graphs (DAG) in MC++ <a href="https://projects.coin-or.org/MCpp">MC++</a>.</p>
<h1><a class="anchor" id="sec_MCIPOPT_solve"></a>
How to Solve an NLP Model using mc::NLPSLV_IPOPT?</h1>
<p>Consider the following NLP: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align*} \max_{\bf p}\ &amp; p_1+p_2 \\ \text{s.t.} \ &amp; p_1\,p_2 \leq 4 \\ &amp; 0 \leq p_1 \leq 6\\ &amp; 0 \leq p_2 \leq 4\,. \end{align*}" src="form_19.png"/>
</p>
<p>We start by defining an <a class="el" href="classmc_1_1NLPSLV__IPOPT.html" title="C++ derived class for NLP solution using IPOPT and FADBAD++. ">mc::NLPSLV_IPOPT</a> class as below, whereby the class <a href="http://www.coin-or.org/Doxygen/Ipopt/class_ipopt_1_1_smart_ptr.html">Ipopt::SmartPtr</a> is used here to comply with the IPOPT C++ interface:</p>
<div class="fragment"><div class="line">Ipopt::SmartPtr&lt;mc::NLPSLV_IPOPT&gt; NLP = <span class="keyword">new</span> <a class="code" href="classmc_1_1NLPSLV__IPOPT.html">mc::NLPSLV_IPOPT</a>;</div>
</div><!-- fragment --><p>Next, we set the variables and objective/constraint functions by creating a DAG of the problem:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;nlpslv_ipopt.hpp&quot;</span></div>
<div class="line"></div>
<div class="line">mc::FFGraph DAG;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">unsigned</span> NP = 2; mc::FFVar P[NP];</div>
<div class="line"><span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> i=0; i&lt;NP; i++ ) P[i].set( &amp;DAG );</div>
<div class="line">NLP-&gt;set_dag( &amp;DAG );                       <span class="comment">// DAG</span></div>
<div class="line">NLP-&gt;set_var( NP, P );                      <span class="comment">// decision variables</span></div>
<div class="line">NLP-&gt;set_obj( BASE_NLP::MAX, P[0]+P[1] );   <span class="comment">// objective</span></div>
<div class="line">NLP-&gt;add_ctr( BASE_NLP::LE, P[0]*P[1]-4. ); <span class="comment">// constraints</span></div>
<div class="line">NLP-&gt;setup();                               <span class="comment">// DAG</span></div>
</div><!-- fragment --><p>Given initial bounds <img class="formulaInl" alt="$P$" src="form_3.png"/> and initial guesses <img class="formulaInl" alt="$p_0$" src="form_4.png"/> on the decision variables, the NLP model is solved as:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;interval.hpp&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">typedef</span> mc::interval I;</div>
<div class="line">I P[NP] = { I(0.,6.), I(0.,4.) };</div>
<div class="line"><span class="keywordtype">double</span> p0[NP] = { 5., 1. };</div>
<div class="line"></div>
<div class="line">Ipopt::ApplicationReturnStatus status = NLP-&gt;solve( P, p0 );</div>
</div><!-- fragment --><p>The return value is of the enumeration type <a href="http://www.coin-or.org/Doxygen/Ipopt/namespace_ipopt.html#efa0497854479cde8b0994cdf132c982">Ipopt::ApplicationReturnStatus</a>. Moreover, the optimization results can be retrieved as follows:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span>( status == Ipopt::Solve_Succeeded ){</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;NLP (LOCAL) SOLUTION: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;  f* = &quot;</span> &lt;&lt; pNLP-&gt;get_objective() &lt;&lt; std::endl;</div>
<div class="line">  <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> ip=0; ip&lt;NP; ip++ )</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;  p*(&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;) = &quot;</span> &lt;&lt; pNLP-&gt;get_variable(ip) &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The following result is displayed here:</p>
<pre class="fragment">NLP (LOCAL) SOLUTION: 
  f* = 6.66667
  p*(0) = 6
  p*(1) = 0.666667
</pre><p>Regarding options, the output level, maximum number of iterations, tolerance, maximum CPU time, etc can all be modified through the public member mc::NLPSLV_IPOPT::options. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Oct 7 2015 20:40:15 for CRONOS by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
